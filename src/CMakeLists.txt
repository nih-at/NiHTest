# for config.h
INCLUDE_DIRECTORIES(BEFORE ${CMAKE_CURRENT_SOURCE_DIR} ${CMAKE_CURRENT_BINARY_DIR}/..)

CHECK_FUNCTION_EXISTS(getopt_long HAVE_GETOPT_LONG)
CHECK_FUNCTION_EXISTS(getprogname HAVE_GETPROGNAME)

SET(COMPATIBILITY_SOURCES)
IF(NOT HAVE_GETOPT_LONG)
  LIST(APPEND COMPATIBILITY_SOURCES getopt_long.c)
ENDIF()
IF(NOT HAVE_GETPROGNAME)
  LIST(APPEND COMPATIBILITY_SOURCES getprogname.c)
ENDIF()


SET(NIHTEST_SOURCES
    nihtest.cc
    Variables.cc
)

ADD_EXECUTABLE(nihtest ${NIHTEST_SOURCES} ${COMPATIBILITY_SOURCES})

# TODO: make installing optional
INSTALL(TARGETS nihtest RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR})

